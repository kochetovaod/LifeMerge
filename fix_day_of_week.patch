diff --git a/Backend/ai_service/main.py b/Backend/ai_service/main.py
index abc1234..def5678 100644
--- a/Backend/ai_service/main.py
+++ b/Backend/ai_service/main.py
@@ -1,5 +1,6 @@
 from datetime import datetime, timedelta, timezone
 from typing import List, Optional, Tuple
+from datetime import datetime as dt, timedelta
 
 from models import ScheduleEntry, Preferences, PlannerSlot, PlannerConflict
 from calendar_client import CalendarEvent
@@ -XX,XX +XX,XX @@ def _build_available_windows(
     windows = []
     for day_offset in range(7):
+        current_date = start_date + timedelta(days=day_offset)
+        weekday = current_date.weekday()  # 0=Mon ... 6=Sun
         if preferences and day_offset in preferences.no_plan_days:
             continue
-        day_schedule = [entry for entry in schedule if entry.day_of_week == day_offset]
+        day_schedule = [entry for entry in schedule if entry.day_of_week == weekday]
         for entry in day_schedule:
-            start_dt = datetime.combine(start_date + timedelta(days=day_offset), entry.start_time, tzinfo=timezone.utc)
-            end_dt = datetime.combine(start_date + timedelta(days=day_offset), entry.end_time, tzinfo=timezone.utc)
+            start_dt = datetime.combine(current_date, entry.start_time, tzinfo=timezone.utc)
+            end_dt = datetime.combine(current_date, entry.end_time, tzinfo=timezone.utc)
             windows.append((start_dt, end_dt))
     return windows
